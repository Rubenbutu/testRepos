(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a925f16"],{7465:function(e,t,s){"use strict";var n=s("f291"),a=s.n(n);a.a},cd83:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"news-grid mt-5"},[s("div",{staticClass:"page-header"},[s("h3",{staticClass:"page-title"},[e._v(" "+e._s(e.add_mode?"Enregistrer un decès":"Editer un decès")+" ")]),s("nav",{attrs:{"aria-label":"breadcrumb"}},[s("ol",{staticClass:"breadcrumb"},[s("li",{staticClass:"breadcrumb-item"},[s("router-link",{attrs:{to:{name:"dashboard"}}},[e._v("Dec7s")])],1),s("li",{staticClass:"breadcrumb-item active",attrs:{"aria-current":"page"}},[e._v(" "+e._s(e.add_mode?"Enregistrer un decès":"Editerun decès")+" ")])])])]),e.is_loading_decess?s("div",{staticClass:"mt-5 pt-4"},[e._m(0)]):e.is_loading_decess?e._e():s("div",{staticClass:"row mt-5"},[s("div",{staticClass:"col-md-12"},[e.is_doing_action?s("div",{staticClass:"card mb-3"},[s("div",{staticClass:"card-body"},[s("div",{staticClass:"circle-loader"}),s("p",{staticClass:"text-center mt-4"},[e._v(e._s(e.loading_message))])])]):e._e(),s("div",{staticClass:"card mb-4"},[s("div",{staticClass:"card-body"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-7"},[s("fieldset",{staticClass:"mt-4",attrs:{disabled:e.is_doing_action}},[s("b-form-group",{attrs:{label:"Nom du defunt :","label-for":"nom"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",id:"nom",placeholder:"Nom"},model:{value:e.deces.nom_defunt,callback:function(t){e.$set(e.deces,"nom_defunt",t)},expression:"deces.nom_defunt"}})],1),s("b-form-group",{attrs:{label:"Postnom du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Postnom du defunt"},model:{value:e.deces.postnom_defunt,callback:function(t){e.$set(e.deces,"postnom_defunt",t)},expression:"deces.postnom_defunt"}})],1),s("b-form-group",{attrs:{label:"Prénom du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Postnom du defunt"},model:{value:e.deces.prenom_defunt,callback:function(t){e.$set(e.deces,"prenom_defunt",t)},expression:"deces.prenom_defunt"}})],1),s("b-form-group",{attrs:{label:"Sexe :","label-for":"sexe_defun"}},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.deces.sexe_defunt,expression:"deces.sexe_defunt"}],staticClass:"form-control",attrs:{id:"sexe_defunt"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.deces,"sexe_defunt",t.target.multiple?s:s[0])}}},[s("option",{domProps:{value:"Masculin"}},[e._v("Masculin")]),s("option",{domProps:{value:"Feminin"}},[e._v("Féminin")])])]),s("b-form-group",{attrs:{label:"Etat civil du defunt :","label-for":"etatc_defunt"}},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.deces.etat_civil_defunt,expression:"deces.etat_civil_defunt"}],staticClass:"form-control",attrs:{id:"etatc_defunt"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.deces,"etat_civil_defunt",t.target.multiple?s:s[0])}}},[s("option",{domProps:{value:"Celibataire"}},[e._v("Célibataire")]),s("option",{domProps:{value:"Epoux"}},[e._v("Marié")])])]),s("b-form-group",{attrs:{label:"Lieu de naissance du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Lieu de naissance du defunt"},model:{value:e.deces.lieu_naissance_defunt,callback:function(t){e.$set(e.deces,"lieu_naissance_defunt",t)},expression:"deces.lieu_naissance_defunt"}})],1),s("b-form-group",{attrs:{label:"Date de naissance du défunt :","label-for":"date_naissance"}},[s("date-picker",{attrs:{valueType:"format",placeholder:"Date de naissance du defunt"},model:{value:e.deces.date_naissance_defunt,callback:function(t){e.$set(e.deces,"date_naissance_defunt",t)},expression:"deces.date_naissance_defunt"}})],1),s("b-form-group",{attrs:{label:"Profession du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Profession du defunt"},model:{value:e.deces.proffesion_defunt,callback:function(t){e.$set(e.deces,"proffesion_defunt",t)},expression:"deces.proffesion_defunt"}})],1),s("b-form-group",{attrs:{label:"Nom du conjoint du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Conjoint du defunt"},model:{value:e.deces.nom_conjoint,callback:function(t){e.$set(e.deces,"nom_conjoint",t)},expression:"deces.nom_conjoint"}})],1),s("b-form-group",{attrs:{label:"Date du decès du défunt :","label-for":"date_naissance"}},[s("date-picker",{attrs:{valueType:"format",placeholder:"Date de decès du defunt"},model:{value:e.deces.date_deces,callback:function(t){e.$set(e.deces,"date_deces",t)},expression:"deces.date_deces"}})],1),s("b-form-group",{attrs:{label:"Nom du père du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Nom du père du defunt"},model:{value:e.deces.nom_pere,callback:function(t){e.$set(e.deces,"nom_pere",t)},expression:"deces.nom_pere"}})],1),s("b-form-group",{attrs:{label:"Lieu de naissance du père du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Lieu de naissance du père du defunt"},model:{value:e.deces.lieu_naissance_pere,callback:function(t){e.$set(e.deces,"lieu_naissance_pere",t)},expression:"deces.lieu_naissance_pere"}})],1),s("b-form-group",{attrs:{label:"Date de naissance du pere du défunt :","label-for":"date_naissance"}},[s("date-picker",{attrs:{valueType:"format",placeholder:"Date de naissance du père du defunt"},model:{value:e.deces.date_naissance_pere,callback:function(t){e.$set(e.deces,"date_naissance_pere",t)},expression:"deces.date_naissance_pere"}})],1),s("b-form-group",{attrs:{label:"Profession du père du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Profession du père du defunt"},model:{value:e.deces.proffesion_pere,callback:function(t){e.$set(e.deces,"proffesion_pere",t)},expression:"deces.proffesion_pere"}})],1),s("b-form-group",{attrs:{label:"Nationalité du père du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Nationalité du père du defunt"},model:{value:e.deces.nationalite_pere,callback:function(t){e.$set(e.deces,"nationalite_pere",t)},expression:"deces.nationalite_pere"}})],1),s("b-form-group",{attrs:{label:"Nom de la mère du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Nom de la mère du defunt"},model:{value:e.deces.nom_mere,callback:function(t){e.$set(e.deces,"nom_mere",t)},expression:"deces.nom_mere"}})],1),s("b-form-group",{attrs:{label:"Lieu de naissance de la mère du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Lieu de naissance de la mère du defunt"},model:{value:e.deces.lieu_naissance_mere,callback:function(t){e.$set(e.deces,"lieu_naissance_mere",t)},expression:"deces.lieu_naissance_mere"}})],1),s("b-form-group",{attrs:{label:"Date de naissance de la mère du défunt :","label-for":"date_naissance"}},[s("date-picker",{attrs:{valueType:"format",placeholder:"Date de naissance de la mère du defunt"},model:{value:e.deces.date_naissance_mere,callback:function(t){e.$set(e.deces,"date_naissance_mere",t)},expression:"deces.date_naissance_mere"}})],1),s("b-form-group",{attrs:{label:"Profession de la mère du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Profession de la mère du defunt"},model:{value:e.deces.proffesion_mere,callback:function(t){e.$set(e.deces,"proffesion_mere",t)},expression:"deces.proffesion_mere"}})],1),s("b-form-group",{attrs:{label:"Nationalité de la mère du defunt :"}},[s("b-form-input",{staticClass:"mb-3",attrs:{type:"text",placeholder:"Nationalité de la mère du defunt"},model:{value:e.deces.nationalite_mere,callback:function(t){e.$set(e.deces,"nationalite_mere",t)},expression:"deces.nationalite_mere"}})],1),s("b-button",{staticClass:"mr-2 mt-4",attrs:{type:"submit",disabled:e.is_doing_action,variant:"success"},on:{click:function(t){e.add_mode?e.doAddDeces():e.doEditDeces()}}},[e._v(e._s(e.add_mode?"Enregistrer le decès":"Enregistrer les modifications apportées"))])],1)])])])])])])])},a=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"card"},[s("div",{staticClass:"card-body"},[s("div",{staticClass:"circle-loader"}),s("p",{staticClass:"text-center mt-4"},[e._v("Chargement de données en cours")])])])}],r=(s("a4d3"),s("99af"),s("4de4"),s("c740"),s("4160"),s("c975"),s("b0c0"),s("e439"),s("dbb4"),s("b64b"),s("d3b7"),s("159b"),s("284c")),i=(s("96cf"),s("89ba")),o=s("2fa7"),c=s("42bc"),d=s("1503"),u=s("ec45");function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function p(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(s,!0).forEach((function(t){Object(o["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var m={props:{add_mode:{type:Boolean,required:!0}},methods:p({},c["a"],{verifierChargement:function(){this.nbr_charges+=1,this.nbr_charges==this.nbr_total_chargements&&(this.is_loading_decess=!1)},loadDeces:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,s,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.constants.api_url+"/deces/"+encodeURIComponent(this.$route.params.id_deces),s=null,e.prev=2,n=new Headers,n.append("Content-type","application/x-www-form-urlencoded"),e.next=7,fetch(t,{method:"get",cache:"no-cache",headers:n});case 7:s=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e["catch"](2),this.$swal({type:"error",title:"La connexion au serveur a échoué",text:e.t0.message}),e.abrupt("return");case 14:return e.next=16,s.json();case 16:a=e.sent,a.id?this.deces=p({},a):this.$swal({type:"error",title:"Une erreur est survenue",text:"Status : "+a.status+"<br/>Message : "+a.message});case 18:case"end":return e.stop()}}),e,this,[[2,10]])})));function t(){return e.apply(this,arguments)}return t}(),loadCollections:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,s,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.constants.api_url+"/collections/get.php",s=null,e.prev=2,n=new Headers,n.append("Content-type","application/x-www-form-urlencoded"),e.next=7,fetch(t,{method:"get",cache:"no-cache",headers:n});case 7:s=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e["catch"](2),this.$swal({type:"error",title:"La connexion au serveur a échoué",text:e.t0.message}),e.abrupt("return");case 14:return e.next=16,s.json();case 16:a=e.sent,"SUCCESS"==a.status&&a.collections?this.listCollections=a.collections:this.$swal({type:"error",title:"Une erreur est survenue",text:"Status : "+a.status+"<br/>Message : "+a.message});case 18:case"end":return e.stop()}}),e,this,[[2,10]])})));function t(){return e.apply(this,arguments)}return t}(),onImageAdded:function(e){this.deces.images=[].concat(Object(r["a"])(this.deces.images),[e])},onImageUpdated:function(e){var t=this.deces.images.findIndex((function(t){return t.id_image==e.id_image}));t>=0&&(this.deces.images[t]=e)},onImageDeleted:function(e){this.deces.images=this.deces.images.filter((function(t){return t.id_image!=e.id_image}))},verifierDeces:function(e){var t="";return void 0==e.nom_defunt||""==e.nom_defunt?t="Veuillez entrer un nom correcte svp":void 0==e.postnom_defunt||""==e.postnom_defunt?t="Veuillez entrer un postnom correcte svp":void 0==e.prenom_defunt||""==e.prenom_defunt?t="Veuillez entrer un prénom correcte svp":void 0==e.sexe_defunt||""==e.sexe_defunt?t="Veuillez sélectionner un sexe svp":void 0!=e.etat_civil_defunt&&""!=e.etat_civil_defunt||(t="Veuillez entrer un état civil correcte svp"),""!=t&&this.$swal({type:"warning",title:"Les données fournies sont incorrcetes",text:t}),{status:""===t,message:t}},doAddDeces:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,s,n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.verifierDeces(this.deces).status){e.next=2;break}return e.abrupt("return");case 2:return this.loading_message="Enregistrement du decès  en cours",this.is_doing_action=!0,t=this.constants.api_url+"/deces/",s=null,e.prev=6,n=p({},this.deces,{user_id:this.utilisateur.id}),delete n.id,a=new Headers,a.append("Content-type","application/x-www-form-urlencoded"),e.next=13,fetch(t,{method:"post",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 13:s=e.sent,e.next=20;break;case 16:return e.prev=16,e.t0=e["catch"](6),this.$swal({type:"error",title:"La connexion au serveur a échoué",text:e.t0.message}),e.abrupt("return");case 20:return e.next=22,s.json();case 22:r=e.sent,r.id>1?(this.deces=this.default_deces,this.$snotify.success("L'deces a été enregistré avec succès.",{timeout:1500,showProgressBar:!1,closeOnClick:!1,pauseOnHover:!0})):this.$swal({type:"error",title:"Une erreur est survenue",text:"Status : "+r.status+"<br/>Message : "+r.message}),this.is_doing_action=!1;case 25:case"end":return e.stop()}}),e,this,[[6,16]])})));function t(){return e.apply(this,arguments)}return t}(),doEditDeces:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,s,n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.verifierDeces(this.deces).status){e.next=2;break}return e.abrupt("return");case 2:return this.loading_message="Enregistrement du decès  en cours",this.is_doing_action=!0,t=this.constants.api_url+"/deces_update/"+encodeURIComponent(this.$route.params.id_deces),s=null,e.prev=6,n=p({},this.deces,{user_id:this.utilisateur.id}),delete n.id,a=new Headers,a.append("Content-type","application/x-www-form-urlencoded"),e.next=13,fetch(t,{method:"post",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 13:s=e.sent,e.next=20;break;case 16:return e.prev=16,e.t0=e["catch"](6),this.$swal({type:"error",title:"La connexion au serveur a échoué",text:e.t0.message}),e.abrupt("return");case 20:return e.next=22,s.json();case 22:r=e.sent,r.success?(this.deces=this.default_deces,this.$snotify.success("Le deces a été enregistré avec succès.",{timeout:1500,showProgressBar:!1,closeOnClick:!1,pauseOnHover:!0}),this.$router.push("/admin/deces/liste-all-deces")):this.$swal({type:"error",title:"Une erreur est survenue",text:"Status : "+r.status+"<br/>Message : "+r.message}),this.is_doing_action=!1;case 25:case"end":return e.stop()}}),e,this,[[6,16]])})));function t(){return e.apply(this,arguments)}return t}(),doUpdateProfilImage:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var s,n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.profile_image_changed||!this.ifile){e.next=20;break}return this.loading_message="Mise à jour de l'image en cours",s=this.constants.api_url+"/decess/change-image.php?id_deces="+t,n=new FormData,n.append("img",this.ifile,this.ifile.name),a=new Headers,a.append("Content-type","application/x-www-form-urlencoded"),e.next=9,fetch(s,{method:"post",body:n,credentials:"include",cache:"no-cache"});case 9:return r=e.sent,e.next=12,r.json();case 12:if(i=e.sent,"SUCCESS"!=i.status){e.next=17;break}return e.abrupt("return",{status:"SUCCESS"});case 17:return e.abrupt("return",i);case 18:e.next=21;break;case 20:return e.abrupt("return",{status:"NO_CHANGE"});case 21:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onProfilImageChange:function(e){var t=this,s=e.target.files[0];if(this.filename="",this.preview_img=null,this.preview_img_base64="",this.ifile=null,s){var n=new FileReader;n.onload=function(){t.img_profil=n.result;var e=n.result.substr(n.result.indexOf(",")+1,n.result.length-(n.result.indexOf(",")+1));t.filename=s.name,t.ifile=s,t.preview_img=t.img_profil,t.preview_img_base64=e,t.profile_image_changed=!0},n.readAsDataURL(s)}},deleteImage:function(){this.filename="",this.preview_img=null,this.preview_img_base64="",this.ifile=null,this.profile_image_changed=!0},getImgObjModel:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return{description:n,id_deces:e,code_contexte:"IMG_JOUEUR",nom_fichier:t,id_image:s}}}),created:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.add_mode||(this.nbr_total_chargements+=1,this.is_loading_decess=!0,this.loadDeces().then((function(){return t.verifierChargement()})));try{this.utilisateur=JSON.parse(sessionStorage.getItem("utilisateur"))}catch(s){this.utilisateur={id:-1}}case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),data:function(){return{constants:d["a"],nbr_total_chargements:0,nbr_charges:0,sortBy:" ",perPage:10,currentPage:1,sortDesc:!1,sortByFormatted:!0,filterByFormatted:!0,sortable:!0,mouvements_deces:[],utilisateur:{id:-1},fields:[{key:"date_mouvement",sortable:!0},{key:"etat_deces",sortable:!1},{key:"observation",sortable:!0}],is_loading_decess:!1,is_doing_action:!1,listCollections:[],deces:{id:-1,nom_defunt:"",postnom_defunt:"",prenom_defunt:"",sexe_defunt:"",lieu_naissance_defunt:"",date_naissance_defunt:"",proffesion_defunt:"",etat_civil_defunt:"",nom_conjoint:"",date_deces:"",nom_pere:"",lieu_naissance_pere:"",date_naissance_pere:"",proffesion_pere:"",nationalite_pere:"",nom_mere:"",lieu_naissance_mere:"",date_naissance_mere:"",proffesion_mere:"",nationalite_mere:""},default_deces:{id:-1,nom_defunt:"",postnom_defunt:"",prenom_defunt:"",sexe_defunt:"",lieu_naissance_defunt:"",date_naissance_defunt:"",proffesion_defunt:"",etat_civil_defunt:"",nom_conjoint:"",date_deces:"",nom_pere:"",lieu_naissance_pere:"",date_naissance_pere:"",proffesion_pere:"",nationalite_pere:"",nom_mere:"",lieu_naissance_mere:"",date_naissance_mere:"",proffesion_mere:"",nationalite_mere:""},loading_message:"Chargement de données en cours",filename:"",preview_img:null,preview_img_base64:"",ifile:null,img_profil:null,profile_image_changed:!1}},components:{DatePicker:u["a"]}},f=m,_=(s("7465"),s("2877")),b=Object(_["a"])(f,n,a,!1,null,"8057e7c8",null);t["a"]=b.exports},f291:function(e,t,s){}}]);
//# sourceMappingURL=chunk-4a925f16.68bbf91e.js.map