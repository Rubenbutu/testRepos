{"version":3,"sources":["webpack:///./src/assets/icone-police.png","webpack:///./src/pages/admin/fast-alert.vue?ccc0","webpack:///src/pages/admin/fast-alert.vue","webpack:///./src/pages/admin/fast-alert.vue?b79d","webpack:///./src/pages/admin/fast-alert.vue"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","is_doing_action","staticStyle","_v","_s","action_message","attrs","on","doActionAlert","staticRenderFns","ascIcon","descIcon","data","constants","computed","methods","getUserLocalisation","onDone","message","alert","type","title","text","$swal","navigator","geolocation","getCurrentPosition","onSuccess","onError","component"],"mappings":"qGAAAA,EAAOC,QAAU,IAA0B,iC,yCCA3C,IAAIC,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,oDAAoD,CAACF,EAAG,MAAM,CAACE,YAAY,8BAA8B,CAACF,EAAG,MAAQJ,EAAIO,gBAAuZH,EAAG,MAAM,CAACA,EAAG,MAAM,CAACA,EAAG,OAAO,CAACE,YAAY,2CAA2CE,YAAY,CAAC,MAAQ,QAAQ,OAAS,WAAWJ,EAAG,IAAI,CAACE,YAAY,QAAQ,CAACN,EAAIS,GAAGT,EAAIU,GAAGV,EAAIW,uBAA5jBP,EAAG,MAAM,CAACA,EAAG,SAAS,CAACE,YAAY,iCAAiCE,YAAY,CAAC,MAAQ,QAAQ,OAAS,QAAQ,gBAAgB,OAAOI,MAAM,CAAC,KAAO,UAAUC,GAAG,CAAC,MAAQ,WAAc,OAAOb,EAAIc,mBAAqB,CAACV,EAAG,MAAM,CAACI,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQI,MAAM,CAAC,IAAM,EAAQ,QAA6B,IAAM,UAAUR,EAAG,MAAMA,EAAG,MAAMJ,EAAIS,GAAG,6BAC1mBM,EAAkB,G,uvBCMtB,sBACEC,QAAS,qCACTC,SAAU,qCAGZ,OACEC,KAAM,WACJ,MAAO,CACLC,UAAN,OACMR,eAAN,GACMJ,iBAAN,IAGE,QARF,mPAUEa,SAAU,EAAZ,GACA,gBACA,eACA,kBACA,iBACA,eAGEC,QAAS,EAAX,GACA,OADA,CAEIC,oBAFJ,SAEA,cACMrB,KAAKU,eAAiB,wBACtBV,KAAKM,iBAAkB,EACvB,IAAN,cACQ,IAAR,oBACA,qBAEQ,EAAR,mBACA,GACUgB,EAAO,CAAjB,0BAGA,cACQ,EAAR,mBACQ,IAAR,KACA,4BACUC,EAAU,uBACpB,+BACUA,EAAU,sDACpB,kBACUA,EAAU,uCACpB,0BACUA,EAAU,sCAEpB,QACUC,MAAMD,GACN,EAAV,OACYE,KAAM,QACNC,MAAO,SACPC,KAAMJ,MAKZ,IAAN,sBAUQ,OAPAC,MAAM,iEACNxB,KAAK4B,MAAM,CACTH,KAAM,QACNC,MAAO,6BACPC,KAAM,6DANRE,UAAUC,YAAYC,mBAAmBC,EAAWC,IAYxD,cAjDJ,oEAiDA,KAjDA,kGAkDA,8CACA,wBAEA,mCACA,OAtDA,kBAyDA,SACA,cACA,iBACA,SACA,mCAGA,qBACA,aACA,4BACA,oBACA,0BApEA,OAyDA,EAzDA,mEA8EA,YACA,aACA,yCACA,oBAjFA,4CAsFA,SAtFA,QAsFA,EAtFA,OAuFA,aACA,YACA,eACA,iBACA,4CAIA,YACA,aACA,gCACA,8BAIA,wBAtGA,qHAwGI,cAxGJ,oLA0GA,YACA,oBACA,4CACA,gBACA,oBACA,0BACA,4BACA,8BACA,6BAlHA,UA0GA,EA1GA,OAoHA,QApHA,iDAuHA,qEAvHA,2GC9BmW,I,YCO/VC,EAAY,eACd,EACApC,EACAgB,GACA,EACA,KACA,KACA,MAIa,aAAAoB,E","file":"js/chunk-61f3b6d4.7061353f.js","sourcesContent":["module.exports = __webpack_public_path__ + \"img/icone-police.8e278d8d.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"d-flex justify-content-center align-items-center\"},[_c('div',{staticClass:\"mt-5 text-center pt-5 mt-4\"},[_c('br'),(!_vm.is_doing_action)?_c('div',[_c('button',{staticClass:\"btn btn-lg btn-outline-primary\",staticStyle:{\"width\":\"200px\",\"height\":\"200px\",\"border-radius\":\"50%\"},attrs:{\"type\":\"button\"},on:{\"click\":function () { return _vm.doActionAlert(); }}},[_c('img',{staticStyle:{\"width\":\"80px\",\"height\":\"auto\"},attrs:{\"src\":require(\"@/assets/icone-police.png\"),\"alt\":\"logo\"}}),_c('br'),_c('br'),_vm._v(\" Lancer l'alert \")])]):_c('div',[_c('div',[_c('span',{staticClass:\"spinner spinner-border spinner-border-lg\",staticStyle:{\"width\":\"120px\",\"height\":\"120px\"}}),_c('p',{staticClass:\"mt-4\"},[_vm._v(_vm._s(_vm.action_message))])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\r\nimport Vue from \"vue\";\r\nimport SortedTablePlugin from \"vue-sorted-table\";\r\nimport functions from \"../../util/functions.js\";\r\nimport constants from \"../../util/constants\";\r\nimport { mapState } from \"vuex\";\r\n\r\nVue.use(SortedTablePlugin, {\r\n  ascIcon: '<i class=\"mdi mdi-arrow-down\"></i>',\r\n  descIcon: '<i class=\"mdi mdi-arrow-up\"></i>',\r\n});\r\n\r\nexport default {\r\n  data: function () {\r\n    return {\r\n      constants,\r\n      action_message : \"\",\r\n      is_doing_action : false\r\n    };\r\n  },\r\n  async created() {\r\n  },\r\n  computed: {\r\n    ...mapState([\r\n      \"is_connected\",\r\n      \"nom_utilisateur\",\r\n      \"id_utilisateur\",\r\n      \"est_admin\",\r\n    ]),\r\n  },\r\n  methods: {\r\n    ...functions,\r\n    getUserLocalisation(onDone) {\r\n      this.action_message = \"Localisation en cours\";\r\n      this.is_doing_action = true;\r\n      let onSuccess = (position) => {\r\n        let latitude = position.coords.latitude\r\n        let longitude = position.coords.longitude\r\n        //alert(\"Latitude : \" + latitude +  \".\\n Longitude : \" + longitude)\r\n        this.is_doing_action = false;\r\n        if(onDone) {\r\n          onDone({latitude, longitude})\r\n        }\r\n      }\r\n      let onError = (error) => {\r\n        this.is_doing_action = false;\r\n        let message = \"\";\r\n        if(error.code == error.PERMISSION_DENIED) {\r\n          message = \"Autorisation refusée\"\r\n        } else if(error.code == error.POSITION_UNAVAILABLE) {\r\n          message = \"Les informations de localisation sont indisponibles\"\r\n        } else if(error.code == error.TIMEOUT) {\r\n          message = \"La demande de localisation a expirée\"\r\n        } else if(error.code == error.UNKNOWN_ERROR) {\r\n          message = \"Une erreur inconnue s'est produite\"\r\n        }\r\n        if(message!=\"\") {\r\n          alert(message)\r\n          this.$swal({\r\n            type: \"error\",\r\n            title: \"Erreur\",\r\n            text: message,\r\n            //footer: '<a href>Why do I have this issue?</a>'\r\n          });\r\n        }\r\n      }\r\n      if(navigator.geolocation) {\r\n        navigator.geolocation.getCurrentPosition(onSuccess, onError)\r\n      } else {\r\n        alert(\"La géolocalisation est désactivée. Veuillez la réactiver\")\r\n        this.$swal({\r\n          type: \"error\",\r\n          title: \"Géolocalisation désactivée\",\r\n          text: \"La géolocalisation est désactivée. Veuillez la réactiver\",\r\n          //footer: '<a href>Why do I have this issue?</a>'\r\n        });\r\n        return ;\r\n      }\r\n    },\r\n    async doCreateAlert(position, idService) {     \r\n      this.action_message = \"Enregistrement en cours\";\r\n      this.is_doing_action = true;\r\n\r\n      let url = this.constants.api_url + \"/alert/\" ;\r\n      let response = null;\r\n\r\n      try {\r\n        response = await fetch(url, {\r\n          method: \"post\",\r\n          cache: \"no-cache\",\r\n          headers  : {\r\n            \"Content-Type\" : \"application/json\"\r\n          },\r\n          //mode : \"cors\",\r\n          body: JSON.stringify({\r\n            service_id : idService,\r\n            user_id : this.id_utilisateur,\r\n            latitude : position.latitude,\r\n            longitude : position.longitude,\r\n            //ville : \"\",\r\n            //commune : \"\",\r\n            //quartier : \"\",\r\n            //status : \"1\",\r\n            //created_at : this.getISODateTimeString(new Date())\r\n          }),\r\n          //credentials: \"include\",\r\n        });\r\n      } catch (e) {\r\n        this.$swal({\r\n          type: \"error\",\r\n          title: \"La connexion au serveur a échoué\",\r\n          text: e.message,\r\n          //footer: '<a href>Why do I have this issue?</a>'\r\n        });\r\n        return;\r\n      }\r\n      let data = await response.json();\r\n      if (data.success == true) {\r\n        this.$swal({\r\n          type: \"success\",\r\n          title: \"Effectué\",\r\n          text: \"L'alerte a été envoyée avec succès\",\r\n          //footer: '<a href>Why do I have this issue?</a>'\r\n        });\r\n      }  else {\r\n        this.$swal({\r\n          type: \"error\",\r\n          title: \"Une erreur est survenue\",\r\n          text: \"Message : \" + data.message,\r\n          //footer: '<a href>Why do I have this issue?</a>'\r\n        });\r\n      }\r\n      this.is_doing_action = false;\r\n    },\r\n    async doActionAlert()\r\n    {\r\n      let res = await this.$swal({\r\n        title: \"Confirmer ?\",\r\n        text: \"Confirmez-vous l'envoi de l'alerte ?\",\r\n        type: \"question\",\r\n        showCancelButton: true,\r\n        confirmButtonColor: \"#3a3\",\r\n        cancelButtonColor: \"#3085d6\",\r\n        confirmButtonText: \"Confirmer\",\r\n        cancelButtonText: \"Annuler\",\r\n      });\r\n      if (!res.value) {\r\n        return;\r\n      }\r\n      this.getUserLocalisation((position) => this.doCreateAlert(position, 1))\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n\r\n\r\n<template>\r\n  <div class=\"d-flex justify-content-center align-items-center\">\r\n    <div class=\"mt-5 text-center pt-5 mt-4\">\r\n      <br />\r\n\r\n      <div v-if=\"!is_doing_action\">\r\n        <button style=\"width:200px;height : 200px; border-radius: 50%;\" class=\"btn btn-lg btn-outline-primary\" type=\"button\"\r\n            @click=\"() => doActionAlert()\"\r\n        >\r\n          <img\r\n                      src=\"@/assets/icone-police.png\"\r\n                      style=\"width: 80px; height: auto\"\r\n                      alt=\"logo\"\r\n                    /> \r\n              <br/>\r\n              <br/>\r\n          Lancer l'alert\r\n        </button>\r\n      </div>\r\n      <div v-else>\r\n        <div>\r\n          <span style=\"width: 120px; height: 120px;\" class=\"spinner spinner-border spinner-border-lg\"></span>\r\n          <p class=\"mt-4\">{{action_message}}</p>\r\n        </div>\r\n      </div>\r\n \r\n    </div>\r\n  </div>\r\n</template>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./fast-alert.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./fast-alert.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./fast-alert.vue?vue&type=template&id=ab827ad2&\"\nimport script from \"./fast-alert.vue?vue&type=script&lang=js&\"\nexport * from \"./fast-alert.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}