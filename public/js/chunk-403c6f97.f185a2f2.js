(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-403c6f97"],{"3ca3":function(t,e,r){"use strict";var a=r("6547").charAt,i=r("69f3"),s=r("7dd0"),n="String Iterator",o=i.set,c=i.getterFor(n);s(String,"String",(function(t){o(this,{type:n,string:String(t),index:0})}),(function(){var t,e=c(this),r=e.string,i=e.index;return i>=r.length?{value:void 0,done:!0}:(t=a(r,i),e.index+=t.length,{value:t,done:!1})}))},d28b:function(t,e,r){var a=r("746f");a("iterator")},ddb0:function(t,e,r){var a=r("da84"),i=r("fdbc"),s=r("e260"),n=r("9112"),o=r("b622"),c=o("iterator"),l=o("toStringTag"),u=s.values;for(var d in i){var p=a[d],f=p&&p.prototype;if(f){if(f[c]!==u)try{n(f,c,u)}catch(v){f[c]=u}if(f[l]||n(f,l,d),i[d])for(var b in s)if(f[b]!==s[b])try{n(f,b,s[b])}catch(v){f[b]=s[b]}}}},e01a:function(t,e,r){"use strict";var a=r("23e7"),i=r("83ab"),s=r("da84"),n=r("5135"),o=r("861d"),c=r("9bf2").f,l=r("e893"),u=s.Symbol;if(i&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var d={},p=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof p?new u(t):void 0===t?u():u(t);return""===t&&(d[e]=!0),e};l(p,u);var f=p.prototype=u.prototype;f.constructor=p;var b=f.toString,v="Symbol(test)"==String(u("test")),g=/^Symbol\((.*)\)[^)]+$/;c(f,"description",{configurable:!0,get:function(){var t=o(this)?this.valueOf():this,e=b.call(t);if(n(d,t))return"";var r=v?e.slice(7,-1):e.replace(g,"$1");return""===r?void 0:r}}),a({global:!0,forced:!0},{Symbol:p})}},efe6:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"mt-5"},[t._m(0),t.is_loading_articles?r("div",{staticClass:"mt-5 pt-4"},[t._m(1)]):r("div",[r("div",{staticClass:" "},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-body"},[r("div",{staticClass:"row mb-4 d-flex justify-content-start"},[r("div",{staticClass:"col-md-7 justify-content-start"},[r("button",{staticClass:"btn-icon-text d-none btn btn-primary mb-3 mb-md-0",attrs:{type:"button",disabled:t.is_doing_action},on:{click:function(e){return t.$router.push("/admin/agents/nouveau")}}},[r("i",{staticClass:"fa fa-plus btn-icon-prepend"}),t._v(" Nouvel Agent ")])]),r("div",{staticClass:"col-md-5 d-none"},[r("b-form-group",{attrs:{label:"","label-for":"input5"}},[r("b-form-input",{attrs:{type:"text",placeholder:"Rechercher"},model:{value:t.search_text,callback:function(e){t.search_text=e},expression:"search_text"}})],1)],1)]),r("div",{staticClass:"table-responsive"},[r("b-table",{attrs:{items:t.agents,id:"table-list",responsive:"","per-page":t.perPage,"current-page":t.currentPage,fields:t.fields,"sort-by":t.sortBy,"sort-desc":t.sortDesc},on:{"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e}},scopedSlots:t._u([{key:"cell(status)",fn:function(e){return[r("span",{domProps:{innerHTML:t._s(e.value)}})]}},{key:"cell(action)",fn:function(e){return[r("div",{staticClass:"d-flex justify-content-center"},[r("button",{staticClass:"btn btn-sm d-none btn-outline-primary py-1 mr-1",attrs:{title:"Modifier un agent",disabled:t.is_doing_action},on:{click:function(){return t.$router.push("/admin/agents/editer/"+e.value)}}},[r("i",{staticClass:"fa fa-pencil"})]),r("button",{directives:[{name:"b-modal",rawName:"v-b-modal.modalcarte",modifiers:{modalcarte:!0}}],staticClass:"btn btn-sm btn-outline-primary p-2",attrs:{title:"Voir dans la carte",disabled:t.is_doing_action},on:{mouseenter:function(){return t.doSetCurAlert(e.value)}}},[r("i",{staticClass:"fa fa-map"})])])]}},{key:"cell(profil)",fn:function(e){return[r("span",{domProps:{innerHTML:t._s(e.value)}})]}}],null,!1,2838458415)}),r("b-pagination",{attrs:{"total-rows":t.rows,"per-page":t.perPage,"aria-controls":"table-list",align:"right"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)])])])]),r("div",[r("div",[r("b-modal",{attrs:{id:"modalcarte",title:"Localisation de l'alerte",size:"lg"}},[t.is_doing_action?r("div",[r("div",{staticClass:"card mb-4"},[r("div",{staticClass:"card-body"},[r("div",{staticClass:"circle-loader"}),r("p",{staticClass:"text-center mt-4"},[t._v(t._s(t.action_message))])])])]):r("div",[r("div",{staticClass:"card"},[r("div",{staticClass:"card-body"},[r("h6",{staticClass:"card-title"},[t._v("Carte")]),r("div",{staticClass:"map-container"},[r("p",{staticClass:"my-4"},[t._v(" "+t._s(t.curAlerte().latitude)+", "+t._s(t.curAlerte().longitude)+" ")]),r("GmapMap",{staticStyle:{width:"100%",height:"500px"},attrs:{center:{lat:t.curAlerte().latitude,lng:t.curAlerte().longitude},zoom:15,options:{zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0,disableDefaultUi:!0}}},[r("GmapMarker",{attrs:{position:t.google&&new t.google.maps.LatLng(t.curAlerte().latitude,t.curAlerte().longitude),clickable:!0,draggable:!1}})],1)],1)])])])])],1)])])},i=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"page-header"},[r("h3",{staticClass:"page-title"},[t._v("Liste des Agents")]),r("nav",{attrs:{"aria-label":"breadcrumb"}},[r("ol",{staticClass:"breadcrumb"},[r("li",{staticClass:"breadcrumb-item"},[r("a",{attrs:{href:"javascript:void(0);"}},[t._v("Agents")])]),r("li",{staticClass:"breadcrumb-item active",attrs:{"aria-current":"page"}},[t._v(" Liste des Agents ")])])])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"card"},[r("div",{staticClass:"card-body"},[r("div",{staticClass:"circle-loader"}),r("p",{staticClass:"text-center mt-4"},[t._v("Chargement des données en cours")])])])}],s=(r("a4d3"),r("e01a"),r("d28b"),r("4de4"),r("7db0"),r("4160"),r("caad"),r("d81d"),r("e439"),r("dbb4"),r("b64b"),r("d3b7"),r("acd8"),r("2532"),r("3ca3"),r("159b"),r("ddb0"),r("2fa7")),n=(r("96cf"),r("89ba")),o=r("2b0e"),c=r("9871"),l=r.n(c),u=r("42bc"),d=r("1503"),p=r("755e"),f=r("2f62");function b(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function v(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?b(r,!0).forEach((function(e){Object(s["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}o["default"].use(p,{load:{key:"AIzaSyAT9uAsuQPTgLew4c2CmAceEeaLXYeHhsk",libraries:"places"}}),o["default"].use(l.a,{ascIcon:'<i class="mdi mdi-arrow-down"></i>',descIcon:'<i class="mdi mdi-arrow-up"></i>'});var g={data:function(){return{constants:d["a"],position:{latitude:10,longitude:10},currentAlertId:-1,type_agent:"",is_doing_action:!1,action_message:"En cours",sortBy:"Nom & prénom",perPage:10,currentPage:1,sortDesc:!1,sortByFormatted:!0,filterByFormatted:!0,sortable:!0,is_loading_articles:!0,fields:[{key:"n",sortable:!1},{key:"action",sortable:!0},{key:"nom",sortable:!0},{key:"postnom",sortable:!0},{key:"prenom",sortable:!0},{key:"sexe",sortable:!0},{key:"adresse",sortable:!0},{key:"email",sortable:!0},{key:"phone",sortable:!0},{key:"type",sortable:!0},{key:"service",sortable:!0}],utilisateur:{},all_articles:[],list_categories_articles:[],search_text:""}},created:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:try{this.utilisateur=JSON.parse(sessionStorage.getItem("utilisateur"))}catch(e){this.utilisateur={id:-1}}this.doLoadAgents();case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),computed:v({google:p["gmapApi"]},Object(f["b"])(["is_connected","nom_utilisateur","id_utilisateur","est_admin"]),{rows:function(){return this.all_articles.length},agents:function(){var t=this;return this.all_articles.filter((function(e){if(""==t.search_text)return t.all_articles;var r=t.fields.map((function(t){return t.key})).filter((function(t){return"n"!=t&&"action"!=t})),a=!0,i=!1,s=void 0;try{for(var n,o=r[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var c=n.value;if(void 0!=e[c]&&e[c].toLowerCase().toLowerCase().includes(t.search_text.toLowerCase()))return!0}}catch(l){i=!0,s=l}finally{try{a||null==o.return||o.return()}finally{if(i)throw s}}}))}}),methods:v({},u["a"],{doLoadAgents:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,r,a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.is_loading_articles=!0,e=this.constants.api_url+"/usersServices/"+this.utilisateur.service_id,t.next=4,fetch(e,{method:"get",cache:"no-cache",headers:{"Content-Type":"application/json"}});case 4:return r=t.sent,t.next=7,r.json();case 7:a=t.sent,a.success?(i=[{libelle:"Police",id:1},{libelle:"Police Incendie",id:2},{libelle:"Service Social",id:3},{libelle:"Croix rouge",id:4}],s=0,this.all_articles=a.user.map((function(t){s++;var e=s,r=i.find((function(e){return e.id==t.service_id}));return r=r?r.libelle:t.service_id,v({},t,{n:e,date_inscription:u["a"].obtenirDateEtHeureEnFrancais(t.created_at),service:r,action:t.id})}))):this.$swal({type:"error",title:"Une erreur est survenue",text:"Status : "+a.status+"\nMessage : "+a.message}),this.is_loading_articles=!1;case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),curAlerte:function(){var t=this,e=this.all_articles.find((function(e){return e.id==t.currentAlertId}));return e?v({},e,{longitude:parseFloat(e.longitude),latitude:parseFloat(e.latitude)}):{longitude:10,latitude:10}},doSetCurAlert:function(t){this.currentAlertId=t},doDeleteFaq:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var r,a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$swal({title:"Supprimer ?",text:"Voulez-vous vraiment supprimer cet alerte ?",type:"question",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Supprimer",cancelButtonText:"Annuler"});case 2:if(r=t.sent,r.value){t.next=5;break}return t.abrupt("return");case 5:return this.action_message="Suppression  en cours",this.is_doing_action=!0,a=this.constants.api_url+"/get_my_alerts/"+e,i=null,t.prev=9,t.next=12,fetch(a,{method:"delete",cache:"no-cache",body:JSON.stringify(this.article),credentials:"include"});case 12:i=t.sent,t.next=19;break;case 15:return t.prev=15,t.t0=t["catch"](9),this.$swal({type:"error",title:"La connexion au serveur a échoué",text:t.t0.message}),t.abrupt("return");case 19:return t.next=21,i.json();case 21:s=t.sent,"SUCCESS"==s.status?(this.all_articles=this.all_articles.filter((function(t){return t.id!=e})),this.$swal({type:"success",title:"Effectué",text:"La article a été supprimée avec succès. "})):this.$swal({type:"error",title:"Une erreur est survenue",text:"Status : "+s.status+"<br/>Message : "+s.message}),this.is_doing_action=!1;case 24:case"end":return t.stop()}}),t,this,[[9,15]])})));function e(e){return t.apply(this,arguments)}return e}(),getUserLocalisation:function(t){var e=this;this.action_message="Localisation en cours",this.is_loading_articles=!0;var r=function(r){var a=r.coords.latitude,i=r.coords.longitude;e.is_loading_articles=!1,t&&t({latitude:a,longitude:i})},a=function(t){e.is_loading_articles=!1;var r="";t.code==t.PERMISSION_DENIED?r="Autorisation refusée":t.code==t.POSITION_UNAVAILABLE?r="Les informations de localisation sont indisponibles":t.code==t.TIMEOUT?r="La demande de localisation a expirée":t.code==t.UNKNOWN_ERROR&&(r="Une erreur inconnue s'est produite"),""!=r&&(alert(r),e.$swal({type:"error",title:"Erreur",text:r}))};if(!navigator.geolocation)return alert("La géolocalisation est désactivée. Veuillez la réactiver"),void this.$swal({type:"error",title:"Géolocalisation désactivée",text:"La géolocalisation est désactivée. Veuillez la réactiver"});navigator.geolocation.getCurrentPosition(r,a)}})},m=g,h=r("2877"),y=Object(h["a"])(m,a,i,!1,null,null,null);e["default"]=y.exports}}]);
//# sourceMappingURL=chunk-403c6f97.f185a2f2.js.map